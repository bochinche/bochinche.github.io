<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Impostor Word Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      line-height: 1.4;
    }
    body {
      margin: 0;
      padding: 1.5rem;
      background: #111827;
      color: #e5e7eb;
    }
    h1, h2, h3 {
      margin-top: 0;
      color: #f9fafb;
    }
    .card {
      background: #1f2937;
      border-radius: 0.75rem;
      padding: 1.25rem;
      margin-bottom: 1rem;
      box-shadow: 0 8px 24px rgba(0,0,0,0.35);
    }
    label {
      display: block;
      margin-bottom: 0.25rem;
      font-size: 0.9rem;
      color: #9ca3af;
    }
    input, select {
      width: 100%;
      padding: 0.5rem 0.75rem;
      border-radius: 0.5rem;
      border: 1px solid #374151;
      background: #111827;
      color: #e5e7eb;
      font-size: 1rem;
      box-sizing: border-box;
    }
    input:focus, select:focus {
      outline: 2px solid #6366f1;
      outline-offset: 1px;
      border-color: #6366f1;
    }
    button {
      border: none;
      border-radius: 999px;
      padding: 0.55rem 1.2rem;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      background: #6366f1;
      color: white;
      display: inline-flex;
      align-items: center;
      gap: 0.35rem;
    }
    button.secondary {
      background: #374151;
    }
    button:disabled {
      opacity: 0.55;
      cursor: not-allowed;
    }
    .row {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
    }
    .row > div {
      flex: 1 1 160px;
    }
    .player-links {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(230px, 1fr));
      gap: 0.75rem;
      margin-top: 0.75rem;
    }
    .player-card {
      border-radius: 0.75rem;
      border: 1px solid #374151;
      padding: 0.75rem;
      background: #0f172a;
      font-size: 0.9rem;
    }
    .player-title {
      font-weight: 600;
      margin-bottom: 0.25rem;
    }
    .small {
      font-size: 0.8rem;
      color: #9ca3af;
    }
    .word-display {
      font-size: 1.8rem;
      font-weight: 700;
      text-align: center;
      margin: 1.5rem 0 0.5rem;
    }
    .tagline {
      font-size: 0.85rem;
      color: #9ca3af;
      text-align: center;
      margin-bottom: 0.75rem;
    }
    .highlight {
      color: #facc15;
    }
    .impostor {
      color: #f97316;
      font-size: 2rem;
    }
    .center {
      text-align: center;
    }
    a {
      color: #a5b4fc;
      word-break: break-all;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    .badge {
      font-size: 0.75rem;
      padding: 0.15rem 0.5rem;
      border-radius: 999px;
      background: #4b5563;
      color: #e5e7eb;
      display: inline-block;
      margin-bottom: 0.25rem;
    }
    @media (min-width: 720px) {
      body {
        max-width: 840px;
        margin: 0 auto;
      }
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    // --- Simple word lists (extend as needed) ---
    const WORDS = {
      es: [
        "aeropuerto", "paraguas", "pizza", "guitarra", "monta√±a",
        "cine", "m√©dico", "volc√°n", "caf√©", "bicicleta",
        "playa", "avi√≥n", "f√∫tbol", "nevera", "ordenador",
        "ventana", "biblioteca", "hotel", "robot", "sat√©lite"
      ],
      en: [
        "airport", "umbrella", "pizza", "guitar", "mountain",
        "cinema", "doctor", "volcano", "coffee", "bicycle",
        "beach", "airplane", "football", "fridge", "computer",
        "window", "library", "hotel", "robot", "satellite"
      ]
    };

    function randomWord(lang) {
      const list = WORDS[lang] || WORDS["es"];
      return list[Math.floor(Math.random() * list.length)];
    }

    function randomInt(max) {
      return Math.floor(Math.random() * max);
    }

    function createGameId() {
      const chars = "ABCDEFGHJKLMNPQRSTUVWXYZ23456789";
      let id = "";
      for (let i = 0; i < 5; i++) {
        id += chars[Math.floor(Math.random() * chars.length)];
      }
      return id;
    }

    function render() {
      const urlParams = new URLSearchParams(window.location.search);
      const role = urlParams.get("role");
      const word = urlParams.get("word");
      const lang = urlParams.get("lang") || "es";
      const playerIndex = urlParams.get("p");
      const impostorFlag = urlParams.get("imp") === "1";

      if (role === "player") {
        renderPlayerView({ word, lang, playerIndex, impostorFlag });
      } else {
        renderHostView();
      }
    }

    function renderPlayerView({ word, lang, playerIndex, impostorFlag }) {
      const app = document.getElementById("app");
      const isEs = lang === "es";

      app.innerHTML = `
        <div class="card">
          <span class="badge">${isEs ? "Vista jugador" : "Player view"}</span>
          <h1>${isEs ? "Impostor" : "Impostor"}</h1>
          <p class="tagline">
            ${isEs
              ? "No ense√±es esta pantalla a nadie. Usa pistas sutiles."
              : "Don‚Äôt show this screen to anyone. Use subtle clues."
            }
          </p>
          <div class="center small">
            ${
              playerIndex !== null
                ? (isEs ? "Jugador" : "Player") + " #" + (parseInt(playerIndex, 10) + 1)
                : ""
            }
          </div>

          <div class="word-display">
            ${
              impostorFlag
                ? `<span class="impostor">${isEs ? "ERES EL IMPOSTOR" : "YOU ARE THE IMPOSTOR"}</span>`
                : `<span>${isEs ? "Tu palabra:" : "Your word:"}</span><br>
                   <span class="highlight">${word || "??"}</span>`
            }
          </div>

          <div class="card" style="margin-top:1.25rem;">
            <h3>${isEs ? "Siguiente paso" : "Next step"}</h3>
            <p class="small">
              ${
                isEs
                  ? "Cuando todos hayan visto su palabra, el anfitri√≥n comenzar√° la ronda de pistas. Di una pista que encaje con la palabra, pero que no la revele."
                  : "When everyone has seen their word, the host will start the clue round. Say a clue that fits the word, but doesn‚Äôt reveal it directly."
              }
            </p>
          </div>
        </div>
      `;
    }

    function renderHostView() {
      const app = document.getElementById("app");
      app.innerHTML = `
        <div class="card">
          <span class="badge">Host</span>
          <h1>Impostor Word Game</h1>
          <p class="tagline">
            Crea una sesi√≥n, genera enlaces para cada jugador y comparte cada enlace.
            N-1 ver√°n la palabra, 1 ver√° ‚ÄúIMPOSTOR‚Äù. Nadie sabe qui√©n es qui√©n hasta el final.
          </p>
        </div>

        <div class="card">
          <h2>Configuraci√≥n de la sesi√≥n</h2>
          <div class="row">
            <div>
              <label for="players">N√∫mero de jugadores</label>
              <input id="players" type="number" min="3" max="20" value="5" />
            </div>
            <div>
              <label for="language">Idioma de la palabra</label>
              <select id="language">
                <option value="es">Espa√±ol</option>
                <option value="en">English</option>
              </select>
            </div>
          </div>
          <div style="margin-top:0.75rem;">
            <label for="customWord">Palabra personalizada (opcional)</label>
            <input id="customWord" type="text" placeholder="d√©jalo vac√≠o para usar una palabra aleatoria" />
          </div>

          <div style="margin-top:1rem;">
            <button id="btnNewSession">
              üÉè Crear nueva sesi√≥n
            </button>
            <button id="btnReveal" class="secondary" disabled>
              üëÄ Revelar impostor
            </button>
          </div>

          <div id="sessionInfo" class="small" style="margin-top:0.75rem; color:#9ca3af;"></div>
        </div>

        <div class="card">
          <h2>Enlaces para los jugadores</h2>
          <p class="small">
            Despu√©s de crear una sesi√≥n, se mostrar√°n aqu√≠ enlaces √∫nicos para cada jugador.
            Cada jugador debe abrir s√≥lo su propio enlace en su m√≥vil.
          </p>
          <div id="playerLinks" class="player-links"></div>
        </div>
      `;

      const btnNewSession = document.getElementById("btnNewSession");
      const btnReveal = document.getElementById("btnReveal");
      const playersInput = document.getElementById("players");
      const languageSelect = document.getElementById("language");
      const customWordInput = document.getElementById("customWord");
      const sessionInfo = document.getElementById("sessionInfo");
      const playerLinksContainer = document.getElementById("playerLinks");

      let currentSession = null;

      btnNewSession.addEventListener("click", () => {
        const nPlayers = parseInt(playersInput.value, 10);
        if (isNaN(nPlayers) || nPlayers < 3) {
          alert("M√≠nimo 3 jugadores.");
          return;
        }

        const lang = languageSelect.value || "es";
        let word = customWordInput.value.trim();
        if (!word) {
          word = randomWord(lang);
        }

        const gameId = createGameId();
        const impostorIndex = randomInt(nPlayers);

        currentSession = {
          gameId,
          lang,
          word,
          nPlayers,
          impostorIndex
        };

        const baseUrl = window.location.origin + window.location.pathname;

        playerLinksContainer.innerHTML = "";
        for (let i = 0; i < nPlayers; i++) {
          const isImpostor = i === impostorIndex;
          const params = new URLSearchParams({
            role: "player",
            lang,
            p: String(i),
            imp: isImpostor ? "1" : "0",
            // everyone gets the word; impostor still sees only "IMPOSTOR"
            word
          });

          const link = `${baseUrl}?${params.toString()}`;

          const div = document.createElement("div");
          div.className = "player-card";
          div.innerHTML = `
            <div class="player-title">
              Jugador #${i + 1}
            </div>
            <div class="small">Enlace:</div>
            <div class="small"><a href="${link}" target="_blank">${link}</a></div>
          `;
          playerLinksContainer.appendChild(div);
        }

        sessionInfo.textContent =
          `ID de sesi√≥n: ${gameId} ¬∑ Palabra: ‚Äú${word}‚Äù`;
        btnReveal.disabled = false;
      });

      btnReveal.addEventListener("click", () => {
        if (!currentSession) return;
        alert(
          `El impostor es el jugador #${currentSession.impostorIndex + 1}\n` +
          `Palabra: ‚Äú${currentSession.word}‚Äù`
        );
      });
    }

    render();
  </script>
</body>
</html>